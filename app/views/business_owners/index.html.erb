<!-- Influencer Finder Section -->
<% content_for :title, "Find Influencers | Influencer Connect" %>
<section class="container mx-auto px-6 py-12 lg:py-24" data-controller="loader">

        <!-- Loader overlay (persistent) -->
        <div data-loader-target="loader" class="hidden absolute inset-0 flex items-center justify-center bg-white/60 z-10">
            <div class="animate-spin rounded-full h-10 w-10 border-t-4 border-blue-500"></div>
        </div>

        <h2 class="text-3xl sm:text-4xl font-extrabold text-center text-gray-200 mb-12">
            Find Your Perfect Influencer
        </h2>

        <!-- Search and Filter Bar -->
        <%= form_with url: business_owners_path,
              method: :get,
              class: "flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4 mb-12",
             data: { turbo_frame: "results" } do %>

        <!-- Search box -->
        <div class="relative w-full max-w-md">
            <%= text_field_tag :q, params[:q], placeholder: "Search by name or keyword...", class: "w-full pl-10 pr-4 py-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-indigo-500" %>
            <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400" ...></svg>
        </div>

        <!-- Influencer type -->
        <div class="relative w-full sm:w-auto">
            <%= select_tag :type,
      options_for_select(
        [["Select Content Type", ""]] + ContentType.pluck(:name).map { |name| [name, name] },
        params[:type]
      ),
      class: "w-full rounded-2xl border-gray-300 dark:border-gray-700
              bg-slate-900 text-white
              dark:bg-slate-900 dark:text-white
              px-4 py-4 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
%>


            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"><i class="fa-solid fa-filter"></i></div>
        </div>

        <!-- City -->
        <div class="relative w-full sm:w-auto">
            <%= render 'shared/city_dropdown' %>
            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"><i class="fa-solid fa-location-dot"></i></div>
        </div>

        <!-- Buttons -->
        <div class="flex space-x-2 w-full sm:w-auto">
            <%= submit_tag "Search", class: "cursor-pointer py-3 px-6 inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition transform hover:scale-105 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 bg-gradient-to-r from-indigo-500 to-purple-600 text-white shadow-md hover:shadow-xl",data: { turbo_stream: true }  %>
        <%= link_to "Reset",
            business_owners_path,
            class: "cursor-pointer inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 border border-input bg-background hover:bg-yellow-500 hover:text-white-foreground",
            data: { turbo_frame: "results", turbo_action: "replace" } %>

        </div>

        <% end %>
        <!-- Placeholder Influencer Cards -->
         <div>
           <turbo-frame id="results" data-loader-target="frame"  class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 relative">
            <!-- Influencers list -->
            <%= render partial: "influencer_card",
                        collection: @influencers,
                        as: :influencer,
                        locals: { contact: true } %>
            </turbo-frame>
        </div>

    </section>