<%# _campaign_card.html.erb - expects local variable `campaign` %>

<div class="bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 rounded-2xl shadow-sm p-5 flex flex-col md:flex-row items-start gap-4">
  <!-- left: image / icon -->
  <div class="flex-shrink-0">
    <!-- replace with real image if you have one -->
    <div class="w-20 h-20 rounded-xl bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-gray-500">
      <i class="fa-solid fa-briefcase"></i>
    </div>
  </div>

  <!-- middle: details -->
  <div class="flex-1">
    <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
      <div>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-gray-100"><%= campaign.content_type.presence || "Campaign" %></h3>
        <p class="text-sm text-gray-500 mt-1"><%= campaign.deliverable_details %></p>
      </div>

      <div class="text-right mt-2 md:mt-0">
        <span class="inline-block text-xs px-2 py-1 rounded-full bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-300 font-medium">
          <%= campaign.created_at.strftime("%b %d, %Y") %>
        </span>
      </div>
    </div>

    <div class="mt-3 grid grid-cols-1 md:grid-cols-2 gap-3">
      <div>
        <p class="text-xs text-gray-500 uppercase tracking-wide">Messages</p>
        <p class="mt-1 text-sm text-gray-700 dark:text-gray-200"><%= truncate(campaign.key_messages.to_s, length: 140) %></p>
      </div>

      <div>
        <p class="text-xs text-gray-500 uppercase tracking-wide">Guidelines</p>
        <p class="mt-1 text-sm text-gray-700 dark:text-gray-200"><%= truncate(campaign.creative_guidelines.to_s, length: 140) %></p>
      </div>

      <div>
        <p class="text-xs text-gray-500 uppercase tracking-wide">City</p>
        <p class="mt-1 text-sm text-gray-700 dark:text-gray-200"><%= truncate(campaign.city.name.to_s, length: 140) %></p>
      </div>
    </div>

    <div class="mt-3 flex flex-wrap gap-2">
      <% tags = campaign.tags_require.to_s.split(",").map(&:strip).reject(&:blank?) %>
      <% tags.each do |t| %>
        <span class="text-xs px-2 py-1 rounded-full border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/40 text-gray-700 dark:text-gray-200">
          <%= t %>
        </span>
      <% end %>
    </div>

    <div class="mt-4 text-sm text-gray-500 flex flex-col md:flex-row gap-6">
      <div>
        <div class="font-medium text-gray-700 dark:text-gray-200">Approval</div>
        <div><%= campaign.approval_deadline&.strftime("%b %d, %Y %I:%M %p") %></div>
      </div>

      <div>
        <div class="font-medium text-gray-700 dark:text-gray-200">Posting Start</div>
        <div><%= campaign.posting_start_date&.strftime("%b %d, %Y %I:%M %p") %></div>
      </div>

      <div>
        <% unless local_assigns[:owner] %>
        <div class="font-medium text-gray-700 dark:text-gray-200">Email</div>
        <div>
          <%= campaign.user.email_address %>
          <%= form_with url: conversations_path, method: :post, data: { turbo: false }, class: "space-y-2 mt-1" do %>
            <%= hidden_field_tag "conversation[receiver_id]", campaign.user.id %>
            <%= submit_tag "Start Chat",
                class: "bg-indigo-500 text-white px-2 py-2 rounded-full hover:bg-indigo-600 transition-colors duration-300 w-full" %>
          <% end %>

        </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- right: actions -->
  <div class="flex-shrink-0 self-stretch flex flex-row md:flex-col items-start md:items-end justify-between mt-4 md:mt-0 gap-2">
    <div class="flex gap-2 md:flex-col">
      <% if local_assigns[:owner] %>
      <%= link_to "View", campaign_path(campaign), class: "inline-flex items-center px-3 py-1.5 rounded-xl border border-gray-200 dark:border-gray-700 text-sm font-medium hover:bg-gray-100 dark:hover:bg-gray-700/50" %>
      <%= link_to "Edit", edit_campaign_path(campaign), class: "inline-flex items-center px-3 py-1.5 rounded-xl bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700" %>
      <%= button_to "Delete", campaign_path(campaign), method: :delete, data: { confirm: "Are you sure?" }, class: "inline-flex items-center px-3 py-1.5 rounded-xl bg-red-600 text-white text-sm font-medium hover:bg-red-700" %>
      <% end %>
    </div>

    <div class="text-xs text-gray-400 mt-2">
      <%= time_ago_in_words(campaign.created_at) %> ago
    </div>
  </div>
</div>
