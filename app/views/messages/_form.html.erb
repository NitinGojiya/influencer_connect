<div id="new_message_form" class="bg-slate-900/50 border-t border-gray-300" data-controller="message">
  <%= form_with model: [conversation, message],
                data: { turbo_stream: true },
                html: { multipart: true },
                class: "p-4 flex flex-col md:flex-row md:items-center md:space-x-2 w-full" do |f| %>

    <!-- Text input -->
    <%= f.text_field :content,
        placeholder: "Type a message...",
        class: "flex-grow rounded-lg bg-slate-900 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 w-full mb-2 md:mb-0" %>

    <!-- Button, preview, loader -->
    <div class="flex flex-col md:flex-row md:items-center md:space-x-2 w-full md:w-auto">
      <div class="flex items-center space-x-2 mb-2 md:mb-0">
        <%= f.file_field :image,
      class: "hidden",
      id: "message_image_input",
      data: { message_target: "input" },
      accept: "image/*,video/*" %>


        <label for="message_image_input"
               class="ml-2 cursor-pointer bg-slate-900/50 px-3 py-2 rounded-lg hover:bg-slate-900/100 flex items-center justify-center">
         <i class="fa-solid fa-photo-film"></i>
        </label>

        <%= f.submit "Send", class: "px-4 py-2 rounded-lg text-lg text-white transition-transform transform hover:scale-105", style: "background: linear-gradient(135deg, #9333ea, #6d28d9);" , data: { message_target: "submitButton" } %>

        <div id="message_loader" class="hidden">
          <span class="loading loading-dots bg-blue-500 loading-md"></span>
        </div>
      </div>

      <!-- Preview container -->
      <div id="image_preview_container" class="flex justify-start md:justify-center space-x-2">
        <img id="image_preview" class="max-h-20 rounded-lg hidden" data-message-target="preview" />
        <div id="video_preview" class="hidden text-red-600 text-3xl" data-message-target="videoPreview">
          <i class="fa-solid fa-video"></i>
        </div>
      </div>

    </div>

  <% end %>
</div>
